{% load static %}
{% load i18n %}

<html class="no-js" lang="ru-RU">
<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="profile" href="https://gmpg.org/xfn/11">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ PROJECT_NAME }}{% endblock %}</title>
    <meta name="description" content="{% block description %}{% endblock %}">

    <link rel="stylesheet" href="{% static 'wp-content/themes/joie/style.css' %}">
    <link rel="profile" href="http://gmpg.org/xfn/11">
    <link rel="stylesheet" href="{% static 'animate.css' %}" />

    <meta property="og:image" content="{% static 'wp-content/uploads/cropped-hh.png' %}" />
    <meta name="twitter:image" content="{% static 'wp-content/uploads/cropped-hh.png' %}" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">

    <meta name='robots' content='max-image-preview:large' />
    <style>
        img:is([sizes="auto" i], [sizes^="auto," i]) {
            contain-intrinsic-size: 3000px 1500px
        }
    </style>

    <link rel="icon" href="{% static 'wp-content/uploads/cropped-icon-2-32x32.png' %}" sizes="32x32" />
    <link rel="icon" href="{% static 'wp-content/uploads/cropped-icon-2-192x192.png' %}" sizes="192x192" />
    <link rel="apple-touch-icon" href="{% static 'wp-content/uploads/cropped-icon-2-180x180.png' %}" />
    <meta name="msapplication-TileImage" content="{% static 'wp-content/uploads/cropped-icon-2-270x270.png' %}" />
</head>

<body class="dark">

    <div class="scroll-progress"></div>

    <header>
        <div class="widget widget_nav_menu">
            <div class="menu-menu-en-container">
                <ul id="menu-menu-en" class="menu">
                    <li id="menu-item-196"
                        class="menu-item menu-item-type-custom menu-item-object-custom menu-item-196">
                        <a href="{% url 'home' %}#a1">
                            <div class="logo-a"> <img src="{% static 'wp-content/uploads/logo-1.png' %}"></div>
                        </a>
                    </li>
                    <li id="menu-item-371"
                        class="act menu-item menu-item-type-custom menu-item-object-custom">
                        <a href="{% url 'home' %}#a1">{% translate 'Home' %}</a>
                    </li>
                    <li id="menu-item-222"
                        class="menu-item menu-item-type-custom menu-item-object-custom">
                        <a href="{% url 'home' %}#team">{% translate 'Our Team' %}</a>
                    </li>
                    <li id="menu-item-333"
                        class="menu-item menu-item-type-custom menu-item-object-custom">
                        <a href="{% url 'home' %}#providers">{% translate 'Providers' %}</a>
                    </li>
                    <li id="menu-item-236"
                        class="menu-item menu-item-type-custom menu-item-object-custom">
                        <a href="{% url 'home' %}#a3">{% translate 'Coverage map' %}</a>
                    </li>
                    <li id="menu-item-338"
                        class="p menu-item menu-item-type-custom menu-item-object-custom">
                        <a href="{% url 'home' %}#.">
                            <a class="openPopup a21">
                                <i class="fa-regular fa-envelope"></i><span>{% translate 'Get a quote' %}</span>
                            </a>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <div class="mobile-header">
        <div class="logo-a">
            <a href="{% url 'home' %}">
                <img src="{% static 'wp-content/uploads/logo-1.png' %}">
            </a>
        </div>
        <a class="b-menu magic-hover magic-hover__square"><b></b><b></b><b></b></a>
    </div>

    <div id="body-back-fon"></div>
    <button id="theme-toggle"><i class="fa-solid fa-moon"></i><i class="fa-solid fa-sun"></i></button>

    {% block content %}{% endblock %}

    <div class="popup" id="popup"><b id="close_vid"><a href="{% url 'home' %}#.">+</a></b>

        <div class="wpcf7 no-js" id="wpcf7-f157-p73-o1" lang="ru-RU" dir="ltr" data-wpcf7-id="157">
            <div class="screen-reader-response">
                <p role="status" aria-live="polite" aria-atomic="true"></p>
                <ul></ul>
            </div>
            <form action="/api/mails/contact/" id="contact-form" method="post" class="wpcf7-form init"
                aria-label="{% translate 'Contact Form' %}" novalidate="novalidate" data-status="init">
                {% csrf_token %}
                <p>
                    <label> {% translate 'Name' %}
                        <span class="wpcf7-form-control-wrap" data-name="name">
                            <input size="40" maxlength="400"
                                class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" autocomplete="name"
                                aria-required="true" aria-invalid="false" value="" type="text" name="name" />
                        </span>
                        <span class="error-message" id="name-error"
                            style="color: red; display: none; font-size: 10px;"></span>
                    </label><br />
                    <label> {% translate 'Email' %}
                        <span class="wpcf7-form-control-wrap" data-name="email">
                            <input size="40" maxlength="400"
                                class="wpcf7-form-control wpcf7-email wpcf7-validates-as-required wpcf7-text wpcf7-validates-as-email"
                                autocomplete="email" aria-required="true" aria-invalid="false" value="" type="email"
                                name="email" />
                        </span>
                        <span class="error-message" id="email-error"
                            style="color: red; display: none; font-size: 10px;"></span>
                    </label><br />
                    <label> {% translate 'Your Question' %}
                        <span class="wpcf7-form-control-wrap" data-name="message">
                            <textarea cols="40" rows="10" maxlength="2000" class="wpcf7-form-control wpcf7-textarea"
                                aria-invalid="false" name="message"></textarea>
                        </span>
                        <span class="error-message" id="message-error"
                            style="color: red; display: none; font-size: 10px;"></span>
                    </label>
                </p>
                <p>
                    <a class="a21">
                        <span>
                            <i class="fa-solid fa-arrow-right"></i> {% translate 'Send' %}
                            <input class="wpcf7-form-control wpcf7-submit has-spinner" type="submit"
                                value="{% translate 'Send' %}" />
                            <span class="wpcf7-spinner"></span>
                        </span>
                    </a>
                </p>
                <div class="wpcf7-response-output" aria-hidden="true"></div>
            </form>
        </div>
    </div>

    <section id="fuu">
        <center>
            <p>Copyright © {% now "Y" %} Endorphine Stake. {% translate "All rights reserved" %}.</p>
        </center>
    </section>

    <a target="_blank" href="https://joie.com.ua" id="joie">Web developer - joie.com.ua</a>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"
        integrity="sha512-uKQ39gEGiyUJl4AI6L+ekBdGKpGw4xJ55+xyJG7YFlJokPNYegn9KwQ3P8A7aFQAUtUsAQHep+d/lrGqrbPIDQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        window.addEventListener('scroll', function () {
            const elements = document.querySelectorAll('.menu');

            elements.forEach(element => {
                if (window.scrollY > 100) { // Замените 100 на нужное значение
                    element.classList.add('lip');
                } else {
                    element.classList.remove('lip');
                }
            });
        });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>

    <script>
        new WOW({
            offset: 150, // default
            mobile: false,
        }).init();

    </script>
    <script>
        const progressBar = document.querySelector('.scroll-progress');

        const scrollProgressBar = () => {
            // Высота всего документа
            const totalHeight = document.body.scrollHeight - window.innerHeight;

            // Количество прокрученных пикселей
            const scrollDistance = window.scrollY;

            // Рассчитываем процент прокрутки
            let progressPercentage = (scrollDistance / totalHeight) * 100;

            // Ограничиваем значение от 0 до 100
            progressPercentage = Math.max(0, Math.min(100, progressPercentage));

            // Устанавливаем ширину прогресс-бара
            progressBar.style.width = progressPercentage + '%';
        };

        window.addEventListener('scroll', scrollProgressBar);
    </script>

    <script>
        var toggles = document.querySelectorAll("a.b-menu");

        for (var i = toggles.length - 1; i >= 0; i--) {
            var toggle = toggles[i];
            toggleHandler(toggle);
        };

        function toggleHandler (toggle) {
            toggle.addEventListener("click", function (e) {
                e.preventDefault();
                if (this.classList.contains("active") === true) {

                    this.classList.remove("active");
                    document.querySelector('.menu').classList.remove('open');
                    document.querySelector('div#body-back-fon').classList.remove('act');
                    document.querySelector('body').classList.remove('no-scroll');
                } else {
                    this.classList.add("active");
                    document.querySelector(' .menu').classList.add('open');
                    document.querySelector('div#body-back-fon').classList.add('act');
                    document.body.classList.add('act')
                    document.querySelector('body').classList.add('no-scroll');
                }
            });
        }

        document.querySelector("div#body-back-fon").addEventListener("click", function (event) {
            document.querySelector('a.b-menu').classList.remove('active');
            document.querySelector('.menu').classList.remove('open');
            document.querySelector('div#body-back-fon').classList.remove('act');
            document.querySelector('body').classList.remove('no-scroll');
        });

        document.querySelectorAll(".menu a").forEach(function (anchor) {
            anchor.addEventListener("click", function (event) {
                document.querySelector('a.b-menu').classList.remove('active');
                document.querySelector('.menu').classList.remove('open');
                document.querySelector('div#body-back-fon').classList.remove('act');
                document.querySelector('body').classList.remove('no-scroll');
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Элементы попапа и кнопки открытия
            const popup = document.getElementById('popup');
            const closePopupBtn = document.getElementById('close_vid');

            // Получаем все кнопки с классом 'openPopup'
            const openPopupBtns = document.querySelectorAll('.openPopup');

            // Открытие попапа при нажатии на любую из кнопок
            openPopupBtns.forEach(button => {
                button.addEventListener('click', function () {
                    popup.classList.add('open');
                });
            });

            // Закрытие попапа при нажатии на крестик
            closePopupBtn.addEventListener('click', function () {
                popup.classList.remove('open');
            });
        });
    </script>

    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>

    <script>
        $(window).on('load', function () {
            // Запускаем функцию инициализации карусели
            initSmoothScrolling('.carousel-inner', 'smoothscroll');
        });

        function initSmoothScrolling (container, animation) {
            var sliderWidth = 0;
            var animationWidth = 0;
            var sliderHeight = $('> .carousel-item', container).outerHeight(false);

            $('> .carousel-item', container).each(function () {
                animationWidth += $(this).outerWidth(false);
            });

            // Определяем количество видимых слайдов
            var slidesVisible = $(container).width() / $('> .carousel-item:first-of-type', container).outerWidth(false);
            slidesVisible = Math.ceil(slidesVisible);

            // Подсчет слайдов для определения скорости анимации
            var slidesNumber = $('> .carousel-item', container).length;
            var speed = slidesNumber * 6;

            // Добавляем "хвост" карусели
            $('> .carousel-item', container).slice(0, slidesVisible).clone().appendTo(container);

            // Вычисляем ширину слайдера с добавленным хвостом
            $('> .carousel-item', container).each(function () {
                sliderWidth += $(this).outerWidth(false);
            });

            // Устанавливаем размеры слайдера
            $(container).css({ 'width': sliderWidth, 'height': sliderHeight });

            // Вставляем стили в html
            $("<style type='text/css'>@keyframes " + animation + " { 0% { margin-left: 0px; } 100% { margin-left: -" + animationWidth + "px; } } " + $('> .carousel-item:first-of-type', container).selector + " { animation: " + animation + " " + speed + "s linear infinite; }</style>").appendTo("head");

            // Перезапускаем анимацию (для Safari и IE)    
            var cl = $(container).attr("class");
            $(container).removeClass(cl).animate({ 'nothing': null }, 1, function () {
                $(this).addClass(cl);
            });
        }
    </script>

    <script>
        // Функция для плавной прокрутки с отступом -100px
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetID = this.getAttribute('href');
                const targetElement = document.querySelector(targetID);

                if (targetElement) {
                    // Вычисляем позицию элемента с учетом отступа
                    const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - 100;

                    // Плавно прокручиваем к нужной позиции
                    window.scrollTo({
                        top: elementPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Функция для добавления класса "act" к элементу меню
        function updateActiveMenuItem () {
            const sections = document.querySelectorAll('section[id]');
            let currentSection = null;

            // Проходим по всем секциям и проверяем, находится ли секция в области видимости
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                if (window.pageYOffset >= sectionTop - sectionHeight / 3) {
                    currentSection = section;
                }
            });

            // Убираем класс "act" у всех элементов меню
            document.querySelectorAll('#menu-menu-en li').forEach(li => {
                li.classList.remove('act');
            });

            // Добавляем класс "act" к активному элементу меню
            if (currentSection) {
                const activeLink = document.querySelector(`#menu-menu-en a[href="#${currentSection.id}"]`);
                if (activeLink) {
                    activeLink.parentElement.classList.add('act');
                }
            }
        }

        // Запускаем функцию при прокрутке страницы
        window.addEventListener('scroll', updateActiveMenuItem);

        // Запускаем функцию при загрузке страницы
        window.addEventListener('load', updateActiveMenuItem);

        // Отпарвка формы
        document.getElementById('contact-form').addEventListener('submit', function (event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);

            const errorMessages = document.querySelectorAll('.error-message');
            errorMessages.forEach(error => error.style.display = 'none');
            errorMessages.forEach(error => error.textContent = '');

            form.classList.add('submitting');

            fetch(form.action, {
                method: 'POST',
                body: formData,
            })
                .then(response => response.json())
                .then(data => {
                    if (data === "OK") {
                        alert("{% translate 'Thank you, your request has been accepted!' %}");
                        form.reset();
                    } else {
                        for (const [field, messages] of Object.entries(data)) {
                            const errorElement = document.getElementById(`${field}-error`);
                            if (errorElement) {
                                errorElement.style.display = 'inline';
                                errorElement.textContent = messages.join(", ");
                            }
                        }
                    }
                })
                .catch(error => {
                    alert("{% translate 'There was an error sending your request, please try again later.' %}");
                }).finally(() => {
                    form.classList.remove('submitting');
                });
        });

    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const themeToggleBtn = document.getElementById('theme-toggle');
            const currentTheme = localStorage.getItem('theme');

            // Устанавливаем класс темы, если она была ранее сохранена
            if (currentTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }

            themeToggleBtn.addEventListener('click', () => {
                // Переключаем тему, добавляя или удаляя класс
                if (document.body.classList.contains('dark-theme')) {
                    document.body.classList.remove('dark-theme');
                    localStorage.setItem('theme', 'light');
                } else {
                    document.body.classList.add('dark-theme');
                    localStorage.setItem('theme', 'dark');
                }
            });
        });
    </script>
</body>

</html>